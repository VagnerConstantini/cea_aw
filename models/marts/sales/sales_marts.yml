version: 2

models:
  - name: dim_product
    description: "Product dimension built from staging (1 row per product)."
    columns:
      - name: product_key
        description: "Surrogate key (hash of product_id)."
        tests: [not_null, unique]

      - name: product_id
        description: "Natural key from OLTP (Production.ProductID)."
        tests: [not_null]

      - name: product_name
        description: "Product display name."
        tests: [not_null]

      - name: product_subcategory_name
        description: "Optional subcategory name for the product."

      - name: product_category_name
        description: "Optional category name for the product."

  - name: dim_customer
    description: "Customer dimension (person or store) with a single display name."
    columns:
      - name: customer_key
        description: "Surrogate key for the customer (hash of customer_id)."
        tests: [not_null, unique]

      - name: customer_id
        description: "Natural key from source (SALES_CUSTOMER.CustomerID)."
        tests: [not_null, unique]

      - name: customer_type
        description: "Customer classification: Store, Person, or Unknown."
        tests:
          - accepted_values:
              values: ['Store', 'Person', 'Unknown']
              severity: warn

      - name: customer_name
        description: "Display name (store name or person full name)."
        tests: [not_null]

      - name: person_id
        description: "Lineage: FK to PERSON when type=Person (nullable)."

      - name: store_id
        description: "Lineage: FK to STORE when type=Store (nullable)."

  - name: dim_credit_card
    description: "Credit card dimension (brand/type and expiration)."
    columns:
      - name: credit_card_key
        description: "Surrogate key (hash of credit_card_id)."
        tests: [not_null, unique]

      - name: credit_card_id
        description: "Natural key from SALES_CREDITCARD."
        tests: [not_null, unique]

      - name: card_type
        description: "Credit card brand/type"
        tests: [not_null]

  - name: dim_geography
    description: "Geography dimension at City–State–Country grain (ship-to)."
    columns:
      - name: geography_key
        description: "Surrogate key (hash of country_code, state_province_code, city)."
        tests: [not_null, unique]

      - name: city
        description: "City (ship-to)."
        tests: [not_null]

      - name: state_province
        description: "State/Province name."
        tests: [not_null]

      - name: state_province_code
        description: "State/Province code (from source)."
        tests: [not_null]

      - name: country
        description: "Country/Region name."
        tests: [not_null]

      - name: country_code
        description: "Country/Region code."
        tests: [not_null]

  